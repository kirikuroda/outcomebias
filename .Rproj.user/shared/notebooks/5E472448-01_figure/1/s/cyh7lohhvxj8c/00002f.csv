"0","figure_2a <- df_participants %>%"
"0","  mutate("
"0","    distributor = if_else(rating_distributor >= 3, ""risky"", ""sure""),"
"0","    recipient = if_else(rating_recipient >= 3, ""risky"", ""sure""),"
"0","    preference = case_when("
"0","      distributor == ""risky"" & recipient == ""risky"" ~ ""1"","
"0","      distributor == ""sure"" & recipient == ""sure"" ~ ""4"","
"0","      distributor == ""risky"" & recipient == ""sure"" ~ ""2"","
"0","      distributor == ""sure"" & recipient == ""risky"" ~ ""3"""
"0","    )"
"0","  ) %>%"
"0","  count(distributor, recipient, preference) %>%"
"0","  group_by(distributor, .groups = ""drop"") %>%"
"0","  mutate("
"0","    width = (sum(n) / 251) * 2,"
"0","    prop = n / sum(n),"
"0","    height = cumsum(prop) - 0.5 * prop"
"0","  ) %>%"
"0","  ggplot(aes(x = distributor, y = n, fill = fct_rev(preference), width = width)) +"
"0","  geom_bar(stat = ""identity"", position = ""fill"", color = ""white"") +"
"0","  geom_text(aes(y = height, label = n, color = preference)) +"
"0","  scale_x_discrete(expand = c(0, 0), labels = c(""Risky"", ""Sure"")) +"
"0","  scale_y_continuous("
"0","    expand = c(0, 0),"
"0","    breaks = c(0.33, 0.83),"
"0","    labels = c(""Risky"", ""Sure"")"
"0","  ) +"
"0","  scale_color_manual(values = c(""black"", ""black"", ""black"", ""white"")) +"
"0","  scale_fill_manual(values = c(""#0072b2"", ""gray"", ""gray"", ""orange"")) +"
"0","  labs("
"0","    x = ""Decision makers' distributive choices"","
"0","    y = ""Receivers' distributive choices"","
"0","    tag = ""a"""
"0","  ) +"
"0","  guides(fill = FALSE, color = FALSE) +"
"0","  theme("
"0","    axis.line = element_blank(),"
"0","    axis.title.y = element_text(size = 8),"
"0","    plot.tag = element_text(size = 14)"
"0","  )"
"0","figure_2a"
